#!/bin/bash

WIPE="$2"
if [ -z "$2" ]; then
	WIPE=""
fi

if [ "$WIPE" = "wipe" ]; then
	echo "Wiping sling data..."
	rm -rf sling
	rm -rf store
	rm -f derby.log
	rm -rf 2011
fi

if [ "$WIPE" = "clean" ]; then
	echo "Cleaning sling folders, but preserving data..."
	rm -rf sling/felix
	rm -rf sling/startup
	rm -f sling/org.apache.*
	rm -rf sling/logs
fi

mkdir -p sling/logs

nohup java -Dfile.encoding=UTF8 -Xmx512m -XX:MaxPermSize=256m -server -Xdebug -Xrunjdwp:transport=dt_socket,address=9001,server=y,suspend=n -Dcom.sun.management.jmxremote -jar $1 > sling/logs/stdout.log 2>&1 &

